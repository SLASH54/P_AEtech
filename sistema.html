<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instalación GPS</title>
  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="login.css">
    <link rel="icon" href="img/logoAEtech.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* Los estilos CSS se encuentran en el archivo login.css */
        
    </style>
</head>
<body>
    <div class="container">
        <header>
            <img src="img/logoAEtech.png" width="80px" height="80px">
                         <section class="login-section">
    <div class="login-menu">
        <button id="login-button" aria-label="Perfil de usuario">
            <i class="fas fa-user-circle"></i>
        </button>
        <div class="dropdown-menu" id="dropdown-menu">
            <!-- Información del perfil -->
            <div class="profile-info" id="profile-info">
                <img src="img/perfil.jpg" alt="perfil.jpg" class="profile-image">
                <p class="profile-name">Nombre del Usuario</p>
                <p class="profile-email">usuario@email.com</p>
            </div>
            <!-- Botón de cerrar sesión -->
            <button id="logout-button" onclick="logout('logout-button')">Cerrar Sesión</button>
        </div>
    </div>

    <script>
        const loginButton = document.getElementById('login-button');
        const dropdownMenu = document.getElementById('dropdown-menu');
        const profileInfo = document.getElementById('profile-info');
        const logoutButton = document.getElementById('logout-button');

        // Oculta el menú desplegable al principio
        dropdownMenu.style.display = 'none';

        loginButton.addEventListener('click', (event) => {
            event.stopPropagation(); // Evita que el clic se propague
            // Muestra u oculta el menú al hacer clic en el icono
            if (dropdownMenu.style.display === 'none') {
                dropdownMenu.style.display = 'block';
            } else {
                dropdownMenu.style.display = 'none';
            }
        });

        // Cierra el menú si se hace clic fuera de él
        document.addEventListener('click', (event) => {
            if (!loginButton.contains(event.target) && !dropdownMenu.contains(event.target)) {
                dropdownMenu.style.display = 'none';
            }
        });

        

        // Función para actualizar la información del perfil (ejemplo)
        function updateProfileInfo(name, email, image) {
            document.querySelector('.profile-name').textContent = name;
            document.querySelector('.profile-email').textContent = email;
            document.querySelector('.profile-image').src = image;
        }

        
    </script>
</section>


            
        </header>

    <nav class="sidebar-nav">
        <button class="menu-toggle" onclick="toggleMenu()">
            &#9776; 
        </button>

        <ul id="main-menu">
            <li><button onclick="mostrarContenido('Tablero')">Tablero</button></li>
            <li><button onclick="mostrarContenido('organizador-tareas')">Tareas</button></li>
            <li><button onclick="mostrarContenido('Actividades')">Actividades</button></li>
            <li><button onclick="mostrarContenido('Evidencia')">Evidencias</button></li>
            <li><button onclick="mostrarContenido('Sucursales')">Sucursales</button></li>
            <li><button onclick="mostrarContenido('agregar-comentario')">Evaluaciones</button></li>
            <li><button onclick="mostrarContenido('Administracion')">Panel de Administracion</button></li>
            <li><button onclick="mostrarContenido('Clientes')">Clientes</button></li>
        </ul>
    </nav>
        <main>



            
  <section id="Evidencia" class="main-content ">
                <h2>Evidencias</h2>
                <section class="main-info">
                    <h2>Agregar Evidencia</h2>
                    <label for="actividadOriginal">Actividad:</label>
                    <select name="Actividad" id="bxActividades">
                        <option value="" selected disabled>-- Selecciona una opción --</option>
                        <option value="opcion1">CCTV</option>
                        <option value="opcion2">Redes</option>
                        <option value="opcion3">GPS y videovigilancia movil</option>
                        <option value="opcion2">Cercado electrico</option>
                        <option value="opcion2">Comunicaciones</option>
                        <option value="opcion2">Alarmas</option>
                        <option value="opcion2">Control de acceso</option>
                    </select>

                    <label for="sucursal">Sucursal:</label>
                    <select name="Actividad" id="bxActividades">
                        <option value="" selected disabled>-- Selecciona una opción --</option>
                        <option value="opcion1">Calzada Oaxaca, Atlixco</option>
                        <option value="opcion2">15 Poniente, Atlixco</option>
                        <option value="opcion3">25 Sur, Puebla</option>
                        <option value="option4">Punto a convenir con cliente</option>
                    </select>

                    <label for="usuario">Usuario:</label>
                    <input type="text" id="usuario" name="usuario" required>

                    <label for="rol">Rol:</label>
                    <input type="text" id="rol" name="rol" required>

                    <label for="ubicacion">Ubicación:</label>
                    <input type="text" id="ubicacion" name="ubicacion" required>

                    <label for="direccion">Dirección:</label>
                    <input type="text" id="direccion" name="direccion" required>

                    <div class="buttons">
                        <button onclick="verHistorial()">Ver historial</button>
                        <button onclick="editarEvidencia()">Editar evidencia</button>
                        <button onclick="eliminarEvidencia()">Eliminar evidencia</button>
                        <button onclick="agregarImagen()">Agregar Evidencia</button>
                    </div>
                </section>

                <section id="Evidencia" class="main-content "></section>
                <h2>Tareas</h2>
            <div class="evidence-grid">
                <div class="evidence-card">
                    <div class="image-placeholder"><img src="vehicle_back.jpg" alt="Confirmación de ubicación" onerror="this.style.display='none'; this.parentNode.textContent=''"></div>
                    <h3>Confirmación de ubicación</h3>
                    <button class="btn-action" onclick="document.getElementById('file-ubicacion').click()">
                    Subir o Tomar Foto
                </button>
                <input 
                    type="file" 
                    id="file-ubicacion" 
                    data-target="image-ubicacion"
                    accept="image/*" 
                    capture="camera" 
                    style="display: none;"
                    onchange="previewImage(this)">

                    <p>Adjuntar fotografia de la ubicacion del cliente</p>
                    <p>Fotografía: Requerida</p>
                    <p>Valor: *@*</p>
                </div>
                
                <div class="evidence-card">
                    <div class="image-placeholder"><img src="license_plate.jpg" alt="Foto antes de la instalación" onerror="this.style.display='none'; this.parentNode.textContent=''"></div>
                    <h3>Foto antes de la instalación</h3>
                    <button class="btn-action" onclick="document.getElementById('file-pre-instalacion').click()">
                    Subir o Tomar Foto
                </button>
                <input 
                    type="file" 
                    id="file-pre-instalacion" 
                    data-target="image-pre-instalacion"
                    accept="image/*" 
                    capture="camera" 
                    style="display: none;"
                    onchange="previewImage(this)">
                    <p>Adjuntar fotografia de la unidad antes de la instalacion del equipo</p>
                    <p>Fotografía: Requerida</p>
                    <p>Valor: *@*</p>
                    
                </div>

                <div class="evidence-card">
                    <div class="image-placeholder"><img src="imei.jpg" alt="IMEI o ID" onerror="this.style.display='none'; this.parentNode.textContent=''"></div>
                    <h3>IMEI o ID</h3>
                    <button class="btn-action" onclick="document.getElementById('file-pre-instalacion').click()">
                    Subir o Tomar Foto
                    </button>
                    <input 
                        type="file" 
                        id="file-pre-instalacion" 
                        data-target="image-pre-instalacion"
                        accept="image/*" 
                        capture="camera" 
                        style="display: none;"
                        onchange="previewImage(this)">
                    <p>Adjuntar foto del IMEI y/o ID del dispositivo instalado</p>
                    <p>Fotografía: Requerida</p>
                    <p>Valor: *@*</p>
                    
                </div>

                <div class="evidence-card">
                    <div class="image-placeholder"><img src="sim_data.jpg" alt="SIM Datos" onerror="this.style.display='none'; this.parentNode.textContent=''"></div>
                    <h3>SIM Datos</h3>
                    <button class="btn-action" onclick="document.getElementById('file-pre-instalacion').click()">
                    Subir o Tomar Foto
                    </button>
                    <input 
                        type="file" 
                        id="file-pre-instalacion" 
                        data-target="image-pre-instalacion"
                        accept="image/*" 
                        capture="camera" 
                        style="display: none;"
                        onchange="previewImage(this)">
                    <p>Adjuntar fotografia de la SIM instalada en el equipo GPS</p>
                    <p>Fotografía: Requerida</p>
                    <p>Valor: *@*</p>
                
                </div>

                <div class="evidence-card">
                    <div class="image-placeholder"><img src="gps_tracker.jpg" alt="Ubicación GPS" onerror="this.style.display='none'; this.parentNode.textContent=''"></div>
                    <h3>Ubicación GPS</h3>
                        <button class="btn-action" onclick="document.getElementById('file-pre-instalacion').click()">
                    Subir o Tomar Foto
                    </button>
                    <input 
                        type="file" 
                        id="file-pre-instalacion" 
                        data-target="image-pre-instalacion"
                        accept="image/*" 
                        capture="camera" 
                        style="display: none;"
                        onchange="previewImage(this)">
                    <p>Abrir la unidad para tener acceso a la ubicacion del dispositivo GPS</p>
                    <p>Fotografía: Requerida</p>
                    <p>Valor: *@*</p>
                    
                </div>

                <div class="evidence-card">
                    <div class="image-placeholder"><img src="antenna_install.jpg" alt="Instalación antenas GPS GSM" onerror="this.style.display='none'; this.parentNode.textContent=''"></div>
                    <h3>Instalación antenas GPS GSM</h3>
                    <button class="btn-action" onclick="document.getElementById('file-pre-instalacion').click()">
                    Subir o Tomar Foto
                    </button>
                    <input 
                        type="file" 
                        id="file-pre-instalacion" 
                        data-target="image-pre-instalacion"
                        accept="image/*" 
                        capture="camera" 
                        style="display: none;"
                        onchange="previewImage(this)">
                    <p>Adjuntar fotografia de la instalacion de antenas de comunicacion en la unidad</p>
                    <p>Fotografía: Requerida</p>
                    <p>Valor: *@*</p>
                   
                </div>

                <div class="evidence-card">
                    <div class="image-placeholder"><img src="" alt="conexiones Electricas" onerror="this.style.display='none'; this.parentNode.textContent=''"></div>
                    <h3>Conexiones eléctricas</h3>
                    <button class="btn-action" onclick="document.getElementById('file-pre-instalacion').click()">
                    Subir o Tomar Foto
                    </button>
                    <input 
                        type="file" 
                        id="file-pre-instalacion" 
                        data-target="image-pre-instalacion"
                        accept="image/*" 
                        capture="camera" 
                        style="display: none;"
                        onchange="previewImage(this)">
                    <p>Adjuntar fotografia de las conexiones electricas del sistema</p>
                    <p>Fotografía: Requerida</p>
                    <p>Valor: *Ok*</p>
                    
                </div>

                <div class="evidence-card">
                    <div class="image-placeholder"><img src="" alt="Prueba GPS" onerror="this.style.display='none'; this.parentNode.textContent=''"></div>
                    <h3>Prueba GPS</h3>
                    <button class="btn-action" onclick="document.getElementById('file-pre-instalacion').click()">
                    Subir o Tomar Foto
                    </button>
                    <input 
                        type="file" 
                        id="file-pre-instalacion" 
                        data-target="image-pre-instalacion"
                        accept="image/*" 
                        capture="camera" 
                        style="display: none;"
                        onchange="previewImage(this)">
                    <p>Realizar Pruebas de funcionamiento del dispositivo GPS</p>
                    <p>Texto: Requerida</p>
                    <p>Valor: *Ok*</p>
                    
                </div>
                
                <div class="evidence-card">
                    <div class="image-placeholder"><img src="" alt="Agregar Contacto" onerror="this.style.display='none'; this.parentNode.textContent=''"></div>
                    <h3>Agregar contacto</h3>
                    <button class="btn-action" onclick="document.getElementById('file-pre-instalacion').click()">
                    Subir o Tomar Foto
                    </button>
                    <input 
                        type="file" 
                        id="file-pre-instalacion" 
                        data-target="image-pre-instalacion"
                        accept="image/*" 
                        capture="camera" 
                        style="display: none;"
                        onchange="previewImage(this)">
                    <p>Adjuntar fotografia del contacto del Cliente</p>
                    <p>Contacto: Requerida</p>
                    <p>Valor: Contactos: 1</p>
            
                </div>
                
                <div class="evidence-card icon-card" data-card-id="firma-cliente">
                    <div class="image-placeholder signature-display" id="signature-firma-cliente">
                        <span class="card-icon">🤝</span>
                    </div>
                    
                    <h3>Liberación de cliente</h3>
                    <button class="btn-action btn-signature" onclick="openSignaturePad('firma-cliente')">
                        Capturar Firma
                    </button>
                    
                    <p>Nombre del grupo: Sin grupo</p>
                    <p>Firma: Requerida</p>
                    <p id="valor-firma-cliente">Valor: *@*</p>
                </div>
                
                <div class="evidence-card icon-card">
                    <span class="card-icon chat-icon">...</span>
                    <h3>Observaciones</h3>
                    <p>Nombre del grupo: Sin grupo</p>
                    <p>Texto: Requerida</p>
                    <p>Valor: *Na*</p>
                    <button>Subir foto</button>
                </div>
                
                <div class="evidence-card icon-card">
                    <span class="card-icon chat-icon">...</span>
                    <h3>Instalador</h3>
                    <p>Nombre del grupo: Sin grupo</p>
                    <p>Texto: Requerida</p>
                    <p>Valor: *Kevin*</p>
                    <button>Subir foto</button>
                </div>
            </div>
            <div id="signature-modal" class="modal">
                <div class="modal-content">
                    <span class="close-button" onclick="closeSignaturePad()">&times;</span>
                    <h2>Firma del Cliente</h2>
                    <p>Dibuje la firma en el área de abajo:</p>
                    <canvas id="signature-canvas" width="400" height="200"></canvas> 
                    <div class="modal-actions">
                        <button class="btn-signature-clear" onclick="clearSignature()">Limpiar</button>
                        <button class="btn-signature-save" onclick="saveSignature()">Guardar Firma</button>
                    </div>
               </div>
            </div>
            </section>
            </section>



            <section id="Tablero" class="main-content">
             
  <div class="tablero-container">
   <div class="top-bar">
    <div class="social-icons">
     <a href="https://wa.me/2212724031" target="_blank" dm_dont_rewrite_url="true" aria-label="whatsapp" onclick="dm_gaq_push_event &amp; dm_gaq_push_event('socialLink', 'click', 'Whatsapp')"> <span class="dmSocialWhatsapp dm-social-icons-whatsapp oneIcon socialHubIcon style6" aria-hidden="true" data-hover-effect="float" class="social-icon"><img src="img/whatsapp.jpg" alt="whatsapp.jpg"></a></span>
     <a href="https://facebook.com/AETech18" target="_blank" dm_dont_rewrite_url="true" aria-label="facebook" onclick="dm_gaq_push_event &amp;  dm_gaq_push_event('socialLink', 'click', 'Facebook')"> <span class="dmSocialFacebook dm-social-icons-facebook oneIcon socialHubIcon style6" aria-hidden="true" data-hover-effect="float" class="social-icon"><img src="img/facebook.jpg" alt="facebook.jpg"></a></span>
     <a href="http://instagram.com/aetech18" target="_blank" dm_dont_rewrite_url="true" aria-label="instagram" onclick="dm_gaq_push_event &amp; dm_gaq_push_event('socialLink', 'click', 'Instagram')"> <span class="dmSocialInstagram dm-social-icons-instagram oneIcon socialHubIcon style6" aria-hidden="true" data-hover-effect="float" class="social-icon"><img src="img/instagram.jpg" alt="instagram.jpg"></a></span>
     <a href="mailto:contacto@aetech.com.mx" dm_dont_rewrite_url="true" aria-label="email" onclick="dm_gaq_push_event &amp; dm_gaq_push_event('socialLink', 'click', 'Email')" target="_blank"> <span class="dmSocialEmail dm-social-icons-email oneIcon socialHubIcon style6" aria-hidden="true" data-hover-effect="float" class="social-icon"><img src="img/gmail.jpg" alt="gmail.jpg"></a></span>
    </div>
    
    
     <img src="img/imgae.jpg" alt="imgae.jpg">
     


    <div class="contact-info">
     <i class="fas fa-phone"></i> <a class="u_1788509405 default dmDefaultGradient align-center dmCall voipReplacement dmWidget dmNoMark dmWwr" contenteditable="false" onclick=";return dm_gaq_push_event('ClickToCall', 'Call',null,'4f1868a89c9c49a1800af08875200556', this);" id="1788509405" dmle_extension="clicktocall" data-element-type="clicktocall" data-buttonstyle="FLAT_ROUND_ICON" wr="true" data-display-type="block" localization_key_description="googleTranslate.HLc6QEJ.39" icon="true" surround="true" description="Llama ahora" adwords="" icon-name="icon-phone" phone="222 143 4363" text="" image="" target="_blank"> <span class="iconBg" aria-hidden="true"></a> 
     <a class="default dmDefaultGradient align-center dmCall voipReplacement dmWidget dmNoMark dmWwr" href="tel:222 143 4363" contenteditable="false" onclick=";return dm_gaq_push_event('ClickToCall', 'Call',null,'4f1868a89c9c49a1800af08875200556', this);" id="1302615267" dmle_extension="clicktocall" data-element-type="clicktocall" wr="true" data-display-type="block" localization_key_description="googleTranslate.oJ4SyII.32" icon="true" surround="true" description="Llamar" adwords="" icon-name="icon-phone" phone="222 143 4363" text="" image="" target="_blank"> <span class="iconBg" aria-hidden="true"> <span class="icon hasFontIcon icon-phone"></span> 
        </span> 
        <span class="text">Llama ahora</span> 
        <span class="text phoneNumHolder">222 143 4363</span>
     </a>
    </div>
   </div>
   <h2 class="text-2xl font-semibold mb-4 text-blue-700">Resumen Rápido</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-blue-500 text-white p-6 rounded-xl shadow-lg">
                    <i class="fas fa-tasks text-3xl mb-3"></i>
                    <p class="text-xl font-bold">4</p>
                    <p>Tareas Pendientes</p>
                </div>
                <div class="bg-green-500 text-white p-6 rounded-xl shadow-lg">
                    <i class="fas fa-check-circle text-3xl mb-3"></i>
                    <p class="text-xl font-bold">1</p>
                    <p>Tareas Completadas</p>
                </div>
                <div class="bg-yellow-500 text-white p-6 rounded-xl shadow-lg">
                    <i class="fas fa-users text-3xl mb-3"></i>
                    <p class="text-xl font-bold">3</p>
                    <p>Clientes Activos</p>
                </div>
            </div>

   <div class="main-content-area">
    <img id="logo-animado" src="img/logo.jpg" alt="logo.jpg" class="logo.jpg">

    <div class="viva-mexico">
     <span class="viva">Feliz dia de </span>
     <span class="mexico">MUERTOS</span>
    </div>

   

   <div class="bottom-bar">
    <p>© 2025 AE Tech. Todos los derechos reservados.</p>
   </div>
  </div>
     
            </section>


            
            <!-- NUEVO CONTENEDOR ORGANIZADOR DE TAREAS -->
<!-- Sección de Tareas -->
 <section id="organizador-tareas" class="main-content">
    <div class="p-8">
        <h2 class="text-3xl font-bold mb-6 text-gray-800 border-b pb-2">Organizador de Tareas</h2>

        <div class="flex justify-between items-center mb-6">
            <p class="text-gray-600">Gestión centralizada de las tareas asignadas y sus estados.</p>
            <button id="openAddTaskModal" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-300 transform hover:scale-105">
                + Nueva Tarea
            </button>
        </div>

        <div class="bg-white shadow-xl rounded-xl overflow-hidden">
            <table class="min-w-full divide-y divide-gray-200" id="tareasTable">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Título</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Asignado a</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sucursal</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estado</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha Límite</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200" id="tareasBody">
                    <!-- Aquí se cargarán las tareas con JavaScript -->
                    <tr><td colspan="6" class="p-4 text-center text-gray-500">Cargando tareas...</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- MODAL para Agregar/Editar Tarea -->
    <div id="tareaModal" class="fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-50 opacity-0 pointer-events-none transition-opacity duration-300">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg p-6">
            <h3 id="tareaModalTitle" class="text-2xl font-semibold mb-4 border-b pb-2">Crear Nueva Tarea</h3>
            <form id="tareaForm">
                <input type="hidden" id="tareaId">

                <div class="mb-4">
                    <label for="tareaTitulo" class="block text-sm font-medium text-gray-700">Título</label>
                    <input type="text" id="tareaTitulo" name="titulo" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                </div>

                <div class="mb-4">
                    <label for="tareaDescripcion" class="block text-sm font-medium text-gray-700">Descripción</label>
                    <textarea id="tareaDescripcion" name="descripcion" required rows="3" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500"></textarea>
                </div>

                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="tareaAsignadoA" class="block text-sm font-medium text-gray-700">Asignar a Usuario</label>
                        <select id="tareaAsignadoA" name="asignadoA" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <option value="" disabled selected>-- Seleccione Usuario --</option>
                            <!-- Opciones cargadas dinámicamente -->
                        </select>
                    </div>
                    <div>
                        <label for="tareaClienteId" class="block text-sm font-medium text-gray-700">Cliente Asociado</label>
                        <select id="tareaClienteId" name="clienteId" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <option value="" disabled selected>-- Seleccione Cliente --</option>
                        </select>
                    </div>
                    <div>
                        <label for="tareaFechaLimite" class="block text-sm font-medium text-gray-700">Fecha Límite</label>
                        <input type="date" id="tareaFechaLimite" name="fechaLimite" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                </div>

                <div class="mb-4">
                    <label for="tareaDireccionCliente" class="block text-sm font-medium text-gray-700">Dirección del Cliente</label>
                    <input type="text" id="tareaDireccionCliente" name="direccionCliente" readonly class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 bg-gray-100 text-gray-600">
                </div>

                <div class="mb-4">
                    <label for="tareaActividadId" class="block text-sm font-medium text-gray-700">Tipo de Actividad</label>
                    <select id="tareaActividadId" name="actividad" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                        <option value="" disabled selected>-- Seleccione Actividad --</option>
                    </select>
                </div>

                <div class="mb-4">
                    <label for="tareaEstado" class="block text-sm font-medium text-gray-700">Estado</label>
                    <select id="tareaEstado" name="estado" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                        <option value="Pendiente">Pendiente</option>
                        <option value="En Progreso">En Progreso</option>
                        <option value="Completada">Completada</option>
                        <option value="Bloqueada">Bloqueada</option>
                    </select>
                </div>

                <div class="flex justify-end space-x-3 mt-6">
                    <button type="button" id="closeTareaModal" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded-lg transition duration-300">
                        Cancelar
                    </button>
                    <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-300">
                        Guardar Tarea
                    </button>
                </div>
            </form>
        </div>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const btnAgregarTarea = document.getElementById('openAddTaskModal');
        const formTarea = document.getElementById('form-tarea');
        const listaTareas = document.getElementById('lista-tareas');
        const filterTipo = document.getElementById('filter-tipo');
        const contenedorListas = document.getElementById('contenedor-listas');
        const cancelarTareaBtn = document.getElementById('cancelar-tarea');

        // Mostrar/Ocultar formulario y listas cuando se hace clic en "Agregar tarea"
        btnAgregarTarea.addEventListener('click', () => {
            const mostrarFormulario = formTarea.style.display === 'none';
            formTarea.style.display = mostrarFormulario ? 'block' : 'none';
            contenedorListas.style.display = mostrarFormulario ? 'none' : 'flex';
        });

        // Función para crear elemento tarea HTML
        function crearElementoTarea(tarea) {
            const div = document.createElement('div');
            div.classList.add('tarea-item');
            div.style.border = '1px solid #888';
            div.style.marginBottom = '8px';
            div.style.padding = '8px';
            div.style.backgroundColor = '#f9f9f9';
            div.dataset.tipo = tarea.tipo;

            div.innerHTML = `
                <strong>${tarea.actividad}</strong><br>
                <small><strong>Asignado a:</strong> ${tarea.asignado}</small><br>
                <small><strong>Ubicación:</strong> ${tarea.ubicacion}</small><br>
                <small><strong>Tipo Rol:</strong> ${tarea.tipoRol}</small><br>
                <small><strong>Límite:</strong> ${new Date(tarea.limiteTiempo).toLocaleString()}</small><br>
                <button class="editar-tarea">Editar Tarea</button>
                <button class="eliminar-tarea">Eliminar Tarea</button>
                <button class="agregar-evidencia">Agregar Evidencia</button>
            `;

            // Botón "Editar Tarea" - CLAVE: usar una función de cierre
            const editarBtn = div.querySelector('.editar-tarea');
            editarBtn.addEventListener('click', function() {
                editarTarea(tarea); // Llama a la función editarTarea con la tarea
            });

            // Botón "Eliminar Tarea"
            div.querySelector('.eliminar-tarea').addEventListener('click', () => {
                if (confirm('¿Seguro que quieres eliminar esta tarea?')) {
                    div.remove(); // Elimina la tarea del DOM
                }
            });

            // Botón "Agregar Evidencia"
            div.querySelector('.agregar-evidencia').addEventListener('click', () => {
                // Aquí puedes implementar la lógica para agregar evidencia
                alert('Agregar evidencia para: ' + tarea.actividad);
            });

            return div;
        }

        // Envío del formulario
        document.querySelector('#form-tarea').addEventListener('submit', function(event) {
            event.preventDefault();

            const actividad = this.actividad.value;
            const asignado = this.asignado.value;
            const ubicacion = this.ubicacion.value;
            const tipoRol = this['tipo-rol'].value;
            const limiteTiempo = this['limite-tiempo'].value;
            const tipoFiltro = filterTipo.value;

            if(!actividad || !asignado || !ubicacion || !tipoRol || !limiteTiempo) {
                alert('Por favor, completa todos los campos.');
                return;
            }

            const tarea = {
                actividad,
                asignado,
                ubicacion,
                tipoRol,
                limiteTiempo,
                tipo: tipoFiltro
            };

            if(tipoFiltro === 'Todo' || tipoFiltro === tarea.tipo) {
                const tareaElemento = crearElementoTarea(tarea);
                listaTareas.appendChild(tareaElemento);
            }

            this.reset();
            this.style.display = 'none';
            contenedorListas.style.display = 'flex';
        });

        // Cancelar la creación de la tarea
        cancelarTareaBtn.addEventListener('click', function() {
            formTarea.style.display = 'none';
            contenedorListas.style.display = 'flex';
            formTarea.reset();
        });

        // Filtrar tareas por tipo
        document.getElementById('filter-tipo').addEventListener('change', () => {
            const tipoSeleccionado = document.getElementById('filter-tipo').value;

            function filtrarLista(contenedor) {
                Array.from(contenedor.children).forEach(div => {
                    if(tipoSeleccionado === 'Todo' || div.dataset.tipo === tipoSeleccionado) {
                        div.style.display = 'block';
                    } else {
                        div.style.display = 'none';
                    }
                });
            }

            filtrarLista(listaTareas);
        });

        // Función para editar la tarea
        function editarTarea(tarea) {
            // Aquí puedes implementar la lógica para editar la tarea
            alert('Editar tarea: ' + tarea.actividad);
        }
    });
</script>
            <section id="Sucursales" class="main-content">
    <h2>Sucursales</h2>
    <div class="contenedor-tarjetas">

        <!-- Tarjetas de Sucursales  -->
        <div class="tarjeta">
            <div class="map-container">
                <h3>Sucursal Atlixco</h3>
                <p>Calzada Oaxaca #3112, segundo piso, Francisco I. Madero, Atlixco, Puebla</p>
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3771.471895372691!2d-98.2224834!3d19.042978899999998!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x85cfc7032f95847f%3A0x14368cb67647d37!2sAE%20TECH!5e0!3m2!1ses!2smx!4v1759351519212!5m2!1ses!2smx"
                    width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </div>

        <div class="tarjeta">
            <div class="map-container">
                <h3>Punto de Venta Atlixco</h3>
                <p>Calle 15 Poniente #107, Alvaro Obregon, Atlixco, Puebla</p>
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3774.9294048160427!2d-98.43886917431595!3d18.89021274801054!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x85cfb3b2f3c72c4b%3A0x7997679f2d024d6e!2sAE%20TECH!5e0!3m2!1ses!2smx!4v1759349314481!5m2!1ses!2smx"
                    width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </div>

        <div class="tarjeta">
            <div class="map-container">
                <h3>Sucursal Puebla</h3>
                <p>Calle 25 Sur #2710, Benito Juarez, Puebla, Puebla</p>
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3774.670411065148!2d-98.43769879999999!3d18.9016973!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x85cfb47f9d4aa489%3A0xecab6b4b061b7393!2sAE%20TECH!5e0!3m2!1ses!2smx!4v1759350362434!5m2!1ses!2smx"
                    width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </div>
</section>
</section>


<section id="agregar-comentario" class="main-content">
    <h2>Agregar Comentario</h2>
    <form id="form-comentario">
        <div class="form-group">
            <label for="comentario">Comentario:</label>
            <textarea id="comentario" name="comentario" rows="4" required></textarea>
        </div>
        <div class="form-group">
            <label>Calificación:</label>
            <div class="rating">
                <span class="star" data-rating="1">&#9733;</span>
                <span class="star" data-rating="2">&#9733;</span>
                <span class="star" data-rating="3">&#9733;</span>
                <span class="star" data-rating="4">&#9733;</span>
                <span class="star" data-rating="5">&#9733;</span>
                <input type="hidden" id="rating-value" name="rating" value="0">
            </div>
        </div>
        <button type="submit">Publicar Comentario</button>
        <button type="button" id="btn-cancelar-comentario">Cancelar</button>
    </form>

    <section id="lista-comentarios" style="display: none;">
        <h2>Comentarios</h2>
        <!-- Aquí se mostrarán los comentarios -->
        <!-- Ejemplo de un comentario -->
        <div class="comentario">
            <div class="comentario-header">
                <img src="img/default-user.png" alt="Avatar" class="comentario-avatar">
                <div class="comentario-info">
                    <span class="comentario-autor">Nombre del Autor</span>
                    <div class="comentario-calificacion">
                        <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                            class="fas fa-star"></i><i class="far fa-star"></i>
                    </div>
                </div>
            </div>
            <p class="comentario-texto">Este es un ejemplo de comentario. ¡El servicio fue excelente!</p>
        </div>
        <!-- Fin del ejemplo de comentario -->
    </section>
</section>

<script>
            // Función para alternar la visibilidad del menú
        function toggleUserMenu() {
            const menu = document.getElementById('user-dropdown-menu');
            menu.classList.toggle('show');
        }

        // Función para cargar los datos en el menú al iniciar la página
        function loadUserInfo() {
            const name = localStorage.getItem('userName') || 'Usuario';
            const email = localStorage.getItem('userEmail') || 'No logeado';

            document.getElementById('menu-user-name').textContent = name;
            document.getElementById('menu-user-email').textContent = email;
        }

    document.addEventListener('DOMContentLoaded', function () {
        const agregarComentarioSection = document.getElementById('agregar-comentario');
        const formComentario = document.getElementById('form-comentario');
        const listaComentarios = document.getElementById('lista-comentarios');
        const btnCancelarComentario = document.getElementById('btn-cancelar-comentario');
        const stars = document.querySelectorAll('.star');
        const ratingValueInput = document.getElementById('rating-value');
        const profileButton = document.getElementById('user-profile-btn');
        const logoutMenuButton = document.getElementById('menu-logout-btn');

    if (profileButton && logoutMenuButton) {
        // 1. Conecta el botón de perfil para abrir/cerrar el menú
        profileButton.addEventListener('click', toggleUserMenu);
        
        // 2. Conecta el botón de cerrar sesión del menú
        logoutMenuButton.addEventListener('click', logout);
        
        // 3. Carga los datos del usuario
        loadUserInfo();
    }


        // Ocultar la sección de comentarios al cargar la página
        listaComentarios.style.display = 'none';

        // Cancelar la creación del comentario
        btnCancelarComentario.addEventListener('click', function () {
            document.getElementById('comentario').value = '';
            ratingValueInput.value = "0";
            stars.forEach(star => star.classList.remove('selected'));
            
        });

        // Publicar el comentario
        formComentario.addEventListener('submit', function (event) {
            event.preventDefault();

            const comentario = document.getElementById('comentario').value;
            const ratingValue = ratingValueInput.value;

            if (!comentario || ratingValue === "0") {
                alert('Por favor, ingrese un comentario y seleccione una calificación.');
                return;
            }

            // Crear el elemento del comentario
            const nuevoComentario = document.createElement('div');
            nuevoComentario.classList.add('comentario');
            nuevoComentario.innerHTML = `
                <div class="comentario-header">
                    <img src="img/default-user.png" alt="Avatar" class="comentario-avatar">
                    <div class="comentario-info">
                        <span class="comentario-autor">Anónimo</span>
                        <div class="comentario-calificacion">
                            ${generarEstrellas(ratingValue)}
                        </div>
                    </div>
                </div>
                <p class="comentario-texto">${comentario}</p>
            `;

            listaComentarios.appendChild(nuevoComentario);

            // Limpiar el formulario
            document.getElementById('comentario').value = '';
            ratingValueInput.value = "0"; // Reset rating value
            stars.forEach(star => star.classList.remove('selected')); // Remove selected class

            listaComentarios.style.display = 'block'; // Mostrar la lista de comentarios al publicar
        });

        // Función para generar las estrellas según la calificación
        function generarEstrellas(rating) {
            let estrellas = '';
            for (let i = 0; i < rating; i++) {
                estrellas += '<i class="fas fa-star"></i>';
            }
            for (let i = rating; i < 5; i++) {
                estrellas += '<i class="far fa-star"></i>';
            }
            return estrellas;
        }

        // Star rating functionality
        stars.forEach(star => {
            star.addEventListener('click', function () {
                const rating = this.dataset.rating;
                ratingValueInput.value = rating;

                // Highlight selected stars
                stars.forEach(star => star.classList.remove('selected'));
                for (let i = 0; i < rating; i++) {
                    stars[i].classList.add('selected');
                }
            });
        });
    });
</script>


<section id="Administracion" class="main-content">
    <h2>Administración de Usuarios</h2>

    <h3>Usuarios con Roles</h3>
    <div class="datagrid-container">
        <table id="datagridUsuariosRoles">
            <thead>
                <tr>
                    <th>Nombre</th>
                    <th>Email</th>
                    <th>Rol</th>
                    <th>Contraseña</th>
                    <th>Acciones</th> </tr>
            </thead>
            <tbody>
                </tbody>
        </table>
    </div>

    <h3>Clientes</h3>
    <div class="datagrid-container">
        <table id="datagridClientes">
            <thead>
                <tr>
                    <th>Nombre</th>
                    <th>Email</th>
                    <th>Dirección</th> 
                    <th>Teléfono</th>
                    <th>Acciones</th> </tr>
            </thead>
            <tbody>
                </tbody>
        </table>
    </div>

    <div id="editModal" class="modal">
    <div class="modal-content">
        <span class="close-button" onclick="closeModal('editModal')">&times;</span>
        <h3>Editar Registro (<span id="recordType"></span>)</h3>
        
        <form id="editForm">
            <input type="hidden" id="edit-id" name="id">
            <input type="hidden" id="edit-type" name="type">

            <label for="edit-nombre">Nombre:</label>
            <input type="text" id="edit-nombre" name="nombre" required>

            <label for="edit-email">Email:</label>
            <input type="email" id="edit-email" name="email" required>

            <div id="userFields">
                <label for="edit-rol">Rol:</label>
                <select id="edit-rol" name="rol" required>
                    <option value="" selected disabled>-- Selecciona una opción --</option>
                    <option value="Admin">Admin</option>
                    <option value="Ingeniero">Ingeniero</option>
                    <option value="Residente">Residente</option>
                    <option value="Practicante">Practicante</option>
                </select>
            </div>

            <div id="clientFields">
                <label for="edit-direccion">Dirección:</label>
                <input type="text" id="edit-direccion" name="direccion">
                
                <label for="edit-telefono">Teléfono:</label>
                <input type="text" id="edit-telefono" name="telefono">
            </div>

            <button type="submit">Guardar Cambios</button>
        </form>
    </div>
</div>
</section>

<section id="Clientes" class="main-content">
    <div class="form-container">
        <div class="logo-container">
        <img src="img/imgae.jpg" alt="imgae.jpg">
        </div>
        <form id="registroClienteForm"> 
            <div class="form-group">
                <label for="client-nombre">Nombre:</label>
                <input type="text" id="client-nombre" name="nombre" required> 
            </div>
            <div class="form-group">
                <label for="client-email">Email:</label>
                <input type="email" id="client-email" name="email" required>
            </div>
            <div class="form-group">
                <label for="client-direccion">Direccion:</label>
                <input type="text" id="client-direccion" name="direccion" required>
            </div>
            <div class="form-group">
                <label for="client-telefono">Telefono:</label>
                <input type="text" id="client-telefono" name="Telefono" required> 
            </div>
            
            <button type="submit">Registrar Cliente</button>
        </form>
        <button type="button" class="back-btn">Volver</button>
    </div>

    
</section>







<section id="Actividades" class="main-content">
  <h2 class="titulo-seccion">📸 Registro de Evidencias</h2>

  <div id="contenedor-evidencias" class="evidencias-grid">
    <!-- Campo 1 -->
    <div class="card-evidencia">
      <label>Título de la evidencia</label>
      <input type="text" name="titulo[]" placeholder="Ej: Foto antes de la instalación">
      <!-- PREVISUALIZACIÓN DE IMAGEN -->
<div class="preview-container">
  <img class="preview-img" src="" alt="Vista previa" style="display:none;">
</div>

      <label class="label-file">
        <i class="fa-solid fa-camera"></i> Tomar Foto / Elegir Archivo
        <input type="file" name="archivos[]" accept="image/*">
      </label>
    </div>

    <!-- Campo 2 -->
    <div class="card-evidencia">
      <label>Título de la evidencia</label>
      <input type="text" name="titulo[]" placeholder="Ej: Foto después de la instalación">
      <!-- PREVISUALIZACIÓN DE IMAGEN -->
<div class="preview-container">
  <img class="preview-img" src="" alt="Vista previa" style="display:none;">
</div>

      <label class="label-file">
        <i class="fa-solid fa-camera"></i> Tomar Foto / Elegir Archivo
        <input type="file" name="archivos[]" accept="image/*">
      </label>
    </div>
  </div>

  <!-- FIRMA DEL CLIENTE -->
    <section id="firma-cliente" class="firma-section">
    <h2>🖊️ Firma del Cliente</h2>
    <canvas id="signature-pad" width="400" height="200"></canvas>
    <div class="firma-botones">
        <button type="button" id="btnLimpiarFirma">
        <i class="fa-solid fa-eraser"></i> Limpiar
        </button>
        <button type="button" id="btnGuardarFirma">
        <i class="fa-solid fa-floppy-disk"></i> Guardar Firma
        </button>
    </div>
    </section>
  <div class="botones-evidencias">
    <button type="button" id="btnAgregarFoto">
      <i class="fa-solid fa-plus"></i> Agregar Foto Adicional
    </button>


    <button type="button" id="btnGuardarEvidencias">
      <i class="fa-solid fa-floppy-disk"></i> Guardar Evidencias
    </button>
  </div>
</section>

   
    <script>



        // Función para mostrar el contenido de una sección y ocultar las demás
        

        function toggleEvaluacion(element) {
            let detalles = element.parentNode.nextElementSibling;
            if (detalles.style.display === "none") {
                detalles.style.display = "block";
                element.innerHTML = '<i class="fas fa-chevron-up"></i>';
            } else {
                detalles.style.display = "none";
                element.innerHTML = '<i class="fas fa-chevron-down"></i>';
            }
        }

        // --- Lógica de inicialización y actualización ---
        document.addEventListener('DOMContentLoaded', () => {
            // Mostrar la sección de Evidencias por defecto al cargar la página
            mostrarContenido('Tablero');
            checkSession();
            

        const registroClienteForm = document.getElementById('registroClienteForm');
            if(registroClienteForm) {
                registroClienteForm.addEventListener('submit', registerClient);
            }
        
            // 🔑 LLAMAR A LA RESTRICCIÓN AQUÍ 🔑
        restrictAdminSection();
        });

        //Cerrar Sesion
        document.getElementById('logout-button').addEventListener('click', logout);

       

    </script>
    
    <script src="script.js"></script>
</body>
</html>